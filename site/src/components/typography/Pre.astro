---
import type { HTMLTag, Polymorphic } from 'astro/types';
import { TabsRoot, TabsList, TabsPanel, Tab } from '@/components/Tabs.tsx';

type Props<Tag extends HTMLTag = 'pre'> = Polymorphic<{ as: Tag }> & {
  maxWidth?: boolean;
  class?: string;
  hasFrame?: boolean;
  title?: string;
};

const { as: Tag = 'pre', maxWidth = false, class: className, style: _style, title, hasFrame, ...props } = Astro.props;

const language = props['data-language'];
const label = title || language || 'code';

const value = 'code';
---

{
  hasFrame ? (
    <Tag class={className} {...props}>
      <slot />
    </Tag>
  ) : (
    <TabsRoot client:visible>
      <TabsList client:visible label={`${label} code`}>
        <Tab client:visible value={value} initial>
          {label}
        </Tab>
      </TabsList>
      <TabsPanel client:visible value={value} initial>
        <Tag class={className} {...props}>
          <slot />
        </Tag>
      </TabsPanel>
    </TabsRoot>
  )
}
